{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "from sqlalchemy import create_engine"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Extract CSVs into DataFrames"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>index</th>\n",
       "      <th>address</th>\n",
       "      <th>categories</th>\n",
       "      <th>city</th>\n",
       "      <th>claimed</th>\n",
       "      <th>country</th>\n",
       "      <th>cuisines</th>\n",
       "      <th>dateOpened</th>\n",
       "      <th>dateUpdated</th>\n",
       "      <th>descriptions</th>\n",
       "      <th>...</th>\n",
       "      <th>menuURL</th>\n",
       "      <th>name</th>\n",
       "      <th>paymentTypes</th>\n",
       "      <th>phones</th>\n",
       "      <th>postalCode</th>\n",
       "      <th>priceRange</th>\n",
       "      <th>province</th>\n",
       "      <th>sic</th>\n",
       "      <th>twitter</th>\n",
       "      <th>websites</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>2871 Gulf To Bay Blvd</td>\n",
       "      <td>American, American (new), Clearwater Restauran...</td>\n",
       "      <td>Clearwater</td>\n",
       "      <td>NaN</td>\n",
       "      <td>US</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2014-02-01T04:41:06Z</td>\n",
       "      <td>Tags: American (New), American, and Trendy Sta...</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Village Inn Restaurant and Bakery</td>\n",
       "      <td>NaN</td>\n",
       "      <td>7277964988</td>\n",
       "      <td>33759</td>\n",
       "      <td>NaN</td>\n",
       "      <td>FL</td>\n",
       "      <td>8423</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>605 W Main St</td>\n",
       "      <td>Caf and Sandwich Place</td>\n",
       "      <td>Louisville</td>\n",
       "      <td>NaN</td>\n",
       "      <td>US</td>\n",
       "      <td>Vegetarian,  Delicatessen</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2016-07-23T22:37:24Z</td>\n",
       "      <td>Atlantic No. 5, Louisville: See 4 unbiased rev...</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Atlantic No. 5</td>\n",
       "      <td>Yes</td>\n",
       "      <td>5028833398</td>\n",
       "      <td>40202</td>\n",
       "      <td>USD 25.00-40.00</td>\n",
       "      <td>KY</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>atlanticno5.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>3803 9th St S W</td>\n",
       "      <td>American, Barbecue, Puyallup Restaurants, Barb...</td>\n",
       "      <td>Puyallup</td>\n",
       "      <td>NaN</td>\n",
       "      <td>US</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2015-11-19T22:22:31Z</td>\n",
       "      <td>Description:  Famous Dave's is a Barbecue , Am...</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Famous Dave's</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2536040340</td>\n",
       "      <td>98373</td>\n",
       "      <td>USD 10.00 - USD 15.00</td>\n",
       "      <td>WA</td>\n",
       "      <td>5610</td>\n",
       "      <td>NaN</td>\n",
       "      <td>http://famousdaves.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>30 S Main St</td>\n",
       "      <td>Coffee &amp; Tea, Restaurant, Restaurants, Bar, Am...</td>\n",
       "      <td>Oberlin</td>\n",
       "      <td>NaN</td>\n",
       "      <td>US</td>\n",
       "      <td>Coffee &amp; Tea, Restaurants, American,  Bar,  Pu...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2016-06-20T17:47:10Z</td>\n",
       "      <td>The Feve, Oberlin: See 170 unbiased reviews of...</td>\n",
       "      <td>...</td>\n",
       "      <td>/oberlin-oh/mip/the-feve-8940755/menu</td>\n",
       "      <td>The Feve</td>\n",
       "      <td>mastercard, amex, discover, Yes, visa</td>\n",
       "      <td>[\"4407741978\",\"4197741978\",\"4407753064\"]</td>\n",
       "      <td>44074</td>\n",
       "      <td>USD 25.00-40.00</td>\n",
       "      <td>OH</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>http://www.thefeve.com</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>55 Crescent Dr</td>\n",
       "      <td>Sandwich Place and Fast Food Restaurant</td>\n",
       "      <td>Pleasant Hill</td>\n",
       "      <td>yellowpages.com</td>\n",
       "      <td>US</td>\n",
       "      <td>Take Out Restaurants, Asian Restaurants, Resta...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2016-07-23T23:55:05Z</td>\n",
       "      <td>[\"https://www.zagat.com/r/yalla-mediterranean-...</td>\n",
       "      <td>...</td>\n",
       "      <td>/pleasant-hill-ca/mip/yalla-mediterranean-5061...</td>\n",
       "      <td>Quiznos</td>\n",
       "      <td>master card, visa</td>\n",
       "      <td>9258258644</td>\n",
       "      <td>94523</td>\n",
       "      <td>$</td>\n",
       "      <td>CA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>quiznos</td>\n",
       "      <td>http://www.yallamedi.com/</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 30 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   index                address  \\\n",
       "0      0  2871 Gulf To Bay Blvd   \n",
       "1      1          605 W Main St   \n",
       "2      2        3803 9th St S W   \n",
       "3      3           30 S Main St   \n",
       "4      4         55 Crescent Dr   \n",
       "\n",
       "                                          categories           city  \\\n",
       "0  American, American (new), Clearwater Restauran...     Clearwater   \n",
       "1                             Caf and Sandwich Place     Louisville   \n",
       "2  American, Barbecue, Puyallup Restaurants, Barb...       Puyallup   \n",
       "3  Coffee & Tea, Restaurant, Restaurants, Bar, Am...        Oberlin   \n",
       "4            Sandwich Place and Fast Food Restaurant  Pleasant Hill   \n",
       "\n",
       "           claimed country                                           cuisines  \\\n",
       "0              NaN      US                                                NaN   \n",
       "1              NaN      US                          Vegetarian,  Delicatessen   \n",
       "2              NaN      US                                                NaN   \n",
       "3              NaN      US  Coffee & Tea, Restaurants, American,  Bar,  Pu...   \n",
       "4  yellowpages.com      US  Take Out Restaurants, Asian Restaurants, Resta...   \n",
       "\n",
       "  dateOpened           dateUpdated  \\\n",
       "0        NaN  2014-02-01T04:41:06Z   \n",
       "1        NaN  2016-07-23T22:37:24Z   \n",
       "2        NaN  2015-11-19T22:22:31Z   \n",
       "3        NaN  2016-06-20T17:47:10Z   \n",
       "4        NaN  2016-07-23T23:55:05Z   \n",
       "\n",
       "                                        descriptions  ...  \\\n",
       "0  Tags: American (New), American, and Trendy Sta...  ...   \n",
       "1  Atlantic No. 5, Louisville: See 4 unbiased rev...  ...   \n",
       "2  Description:  Famous Dave's is a Barbecue , Am...  ...   \n",
       "3  The Feve, Oberlin: See 170 unbiased reviews of...  ...   \n",
       "4  [\"https://www.zagat.com/r/yalla-mediterranean-...  ...   \n",
       "\n",
       "                                             menuURL  \\\n",
       "0                                                NaN   \n",
       "1                                                NaN   \n",
       "2                                                NaN   \n",
       "3              /oberlin-oh/mip/the-feve-8940755/menu   \n",
       "4  /pleasant-hill-ca/mip/yalla-mediterranean-5061...   \n",
       "\n",
       "                                name                           paymentTypes  \\\n",
       "0  Village Inn Restaurant and Bakery                                    NaN   \n",
       "1                     Atlantic No. 5                                    Yes   \n",
       "2                      Famous Dave's                                    NaN   \n",
       "3                           The Feve  mastercard, amex, discover, Yes, visa   \n",
       "4                            Quiznos                      master card, visa   \n",
       "\n",
       "                                     phones postalCode             priceRange  \\\n",
       "0                                7277964988      33759                    NaN   \n",
       "1                                5028833398      40202        USD 25.00-40.00   \n",
       "2                                2536040340      98373  USD 10.00 - USD 15.00   \n",
       "3  [\"4407741978\",\"4197741978\",\"4407753064\"]      44074        USD 25.00-40.00   \n",
       "4                                9258258644      94523                      $   \n",
       "\n",
       "   province   sic  twitter                   websites  \n",
       "0        FL  8423      NaN                        NaN  \n",
       "1        KY   NaN      NaN            atlanticno5.com  \n",
       "2        WA  5610      NaN     http://famousdaves.com  \n",
       "3        OH   NaN      NaN     http://www.thefeve.com  \n",
       "4        CA   NaN  quiznos  http://www.yallamedi.com/  \n",
       "\n",
       "[5 rows x 30 columns]"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vvr_data_world_file = \"/Users/rajee/gt/RAM-Project/RAM_project/Resources/vegetarian_restaurants_US_datafiniti_vegetarian_restaurants_US_datafiniti.csv\"\n",
    "vvr_df = pd.read_csv(vvr_data_world_file)\n",
    "vvr_indexed_df = vvr_df.reset_index(drop=False, inplace=False, col_fill='')\n",
    "vvr_indexed_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "#use for second datatset\n",
    "\n",
    "# county_file = \"../Resources/CountyLicenseCount.csv\"\n",
    "# county_df = pd.read_csv(county_file)\n",
    "# county_df.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Transform premise DataFrame"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>address</th>\n",
       "      <th>categories</th>\n",
       "      <th>city</th>\n",
       "      <th>country</th>\n",
       "      <th>name</th>\n",
       "      <th>phones</th>\n",
       "      <th>postalcode</th>\n",
       "      <th>pricerange</th>\n",
       "      <th>province</th>\n",
       "      <th>twitter</th>\n",
       "      <th>websites</th>\n",
       "      <th>facebookpageurl</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>2871 Gulf To Bay Blvd</td>\n",
       "      <td>American, American (new), Clearwater Restauran...</td>\n",
       "      <td>Clearwater</td>\n",
       "      <td>US</td>\n",
       "      <td>Village Inn Restaurant and Bakery</td>\n",
       "      <td>7277964988</td>\n",
       "      <td>33759</td>\n",
       "      <td>NaN</td>\n",
       "      <td>FL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>605 W Main St</td>\n",
       "      <td>Caf and Sandwich Place</td>\n",
       "      <td>Louisville</td>\n",
       "      <td>US</td>\n",
       "      <td>Atlantic No. 5</td>\n",
       "      <td>5028833398</td>\n",
       "      <td>40202</td>\n",
       "      <td>USD 25.00-40.00</td>\n",
       "      <td>KY</td>\n",
       "      <td>NaN</td>\n",
       "      <td>atlanticno5.com</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>3803 9th St S W</td>\n",
       "      <td>American, Barbecue, Puyallup Restaurants, Barb...</td>\n",
       "      <td>Puyallup</td>\n",
       "      <td>US</td>\n",
       "      <td>Famous Dave's</td>\n",
       "      <td>2536040340</td>\n",
       "      <td>98373</td>\n",
       "      <td>USD 10.00 - USD 15.00</td>\n",
       "      <td>WA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>http://famousdaves.com</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>30 S Main St</td>\n",
       "      <td>Coffee &amp; Tea, Restaurant, Restaurants, Bar, Am...</td>\n",
       "      <td>Oberlin</td>\n",
       "      <td>US</td>\n",
       "      <td>The Feve</td>\n",
       "      <td>[\"4407741978\",\"4197741978\",\"4407753064\"]</td>\n",
       "      <td>44074</td>\n",
       "      <td>USD 25.00-40.00</td>\n",
       "      <td>OH</td>\n",
       "      <td>NaN</td>\n",
       "      <td>http://www.thefeve.com</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>55 Crescent Dr</td>\n",
       "      <td>Sandwich Place and Fast Food Restaurant</td>\n",
       "      <td>Pleasant Hill</td>\n",
       "      <td>US</td>\n",
       "      <td>Quiznos</td>\n",
       "      <td>9258258644</td>\n",
       "      <td>94523</td>\n",
       "      <td>$</td>\n",
       "      <td>CA</td>\n",
       "      <td>quiznos</td>\n",
       "      <td>http://www.yallamedi.com/</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18150</th>\n",
       "      <td>18150</td>\n",
       "      <td>879 Smith Ave S</td>\n",
       "      <td>West St Paul Restaurants, American / Diner / C...</td>\n",
       "      <td>W St Paul</td>\n",
       "      <td>US</td>\n",
       "      <td>The Old Man River Cafe</td>\n",
       "      <td>6.51E+09</td>\n",
       "      <td>55118</td>\n",
       "      <td>NaN</td>\n",
       "      <td>MN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18151</th>\n",
       "      <td>18151</td>\n",
       "      <td>1410 Colonial Life Blvd W</td>\n",
       "      <td>Restaurant</td>\n",
       "      <td>Columbia</td>\n",
       "      <td>US</td>\n",
       "      <td>The Melting Pot</td>\n",
       "      <td>8037318500</td>\n",
       "      <td>29210-7665</td>\n",
       "      <td>NaN</td>\n",
       "      <td>SC</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18152</th>\n",
       "      <td>18152</td>\n",
       "      <td>9439 Sheridan St</td>\n",
       "      <td>American, Smoothies &amp; Juices, Hollywood Restau...</td>\n",
       "      <td>Hollywood</td>\n",
       "      <td>US</td>\n",
       "      <td>Smoothie King</td>\n",
       "      <td>9544313411</td>\n",
       "      <td>33024</td>\n",
       "      <td>NaN</td>\n",
       "      <td>FL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>http://smoothieking.com</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18153</th>\n",
       "      <td>18153</td>\n",
       "      <td>801 N Congress Ave</td>\n",
       "      <td>[\"Restaurants\",\"Banquet Halls &amp; Reception Faci...</td>\n",
       "      <td>Boynton Beach</td>\n",
       "      <td>US</td>\n",
       "      <td>Buca Di Beppo</td>\n",
       "      <td>[\"5617344558\",\"5617330189\"]</td>\n",
       "      <td>[\"33426\"]</td>\n",
       "      <td>$$</td>\n",
       "      <td>FL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>http://www.bucadibeppo.com</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18154</th>\n",
       "      <td>18154</td>\n",
       "      <td>1603 Delaware 1</td>\n",
       "      <td>Rehoboth Beach Restaurants, Pizza / American /...</td>\n",
       "      <td>Rehoboth Beach</td>\n",
       "      <td>US</td>\n",
       "      <td>Grotto Pizza</td>\n",
       "      <td>3022273407</td>\n",
       "      <td>19971</td>\n",
       "      <td>NaN</td>\n",
       "      <td>DE</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>18155 rows × 13 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          id                    address  \\\n",
       "0          0      2871 Gulf To Bay Blvd   \n",
       "1          1              605 W Main St   \n",
       "2          2            3803 9th St S W   \n",
       "3          3               30 S Main St   \n",
       "4          4             55 Crescent Dr   \n",
       "...      ...                        ...   \n",
       "18150  18150            879 Smith Ave S   \n",
       "18151  18151  1410 Colonial Life Blvd W   \n",
       "18152  18152           9439 Sheridan St   \n",
       "18153  18153         801 N Congress Ave   \n",
       "18154  18154            1603 Delaware 1   \n",
       "\n",
       "                                              categories            city  \\\n",
       "0      American, American (new), Clearwater Restauran...      Clearwater   \n",
       "1                                 Caf and Sandwich Place      Louisville   \n",
       "2      American, Barbecue, Puyallup Restaurants, Barb...        Puyallup   \n",
       "3      Coffee & Tea, Restaurant, Restaurants, Bar, Am...         Oberlin   \n",
       "4                Sandwich Place and Fast Food Restaurant   Pleasant Hill   \n",
       "...                                                  ...             ...   \n",
       "18150  West St Paul Restaurants, American / Diner / C...       W St Paul   \n",
       "18151                                         Restaurant        Columbia   \n",
       "18152  American, Smoothies & Juices, Hollywood Restau...       Hollywood   \n",
       "18153  [\"Restaurants\",\"Banquet Halls & Reception Faci...   Boynton Beach   \n",
       "18154  Rehoboth Beach Restaurants, Pizza / American /...  Rehoboth Beach   \n",
       "\n",
       "      country                               name  \\\n",
       "0          US  Village Inn Restaurant and Bakery   \n",
       "1          US                     Atlantic No. 5   \n",
       "2          US                      Famous Dave's   \n",
       "3          US                           The Feve   \n",
       "4          US                            Quiznos   \n",
       "...       ...                                ...   \n",
       "18150      US             The Old Man River Cafe   \n",
       "18151      US                    The Melting Pot   \n",
       "18152      US                      Smoothie King   \n",
       "18153      US                      Buca Di Beppo   \n",
       "18154      US                       Grotto Pizza   \n",
       "\n",
       "                                         phones  postalcode  \\\n",
       "0                                    7277964988       33759   \n",
       "1                                    5028833398       40202   \n",
       "2                                    2536040340       98373   \n",
       "3      [\"4407741978\",\"4197741978\",\"4407753064\"]       44074   \n",
       "4                                    9258258644       94523   \n",
       "...                                         ...         ...   \n",
       "18150                                  6.51E+09       55118   \n",
       "18151                                8037318500  29210-7665   \n",
       "18152                                9544313411       33024   \n",
       "18153               [\"5617344558\",\"5617330189\"]   [\"33426\"]   \n",
       "18154                                3022273407       19971   \n",
       "\n",
       "                  pricerange province  twitter                    websites  \\\n",
       "0                        NaN       FL      NaN                         NaN   \n",
       "1            USD 25.00-40.00       KY      NaN             atlanticno5.com   \n",
       "2      USD 10.00 - USD 15.00       WA      NaN      http://famousdaves.com   \n",
       "3            USD 25.00-40.00       OH      NaN      http://www.thefeve.com   \n",
       "4                          $       CA  quiznos   http://www.yallamedi.com/   \n",
       "...                      ...      ...      ...                         ...   \n",
       "18150                    NaN       MN      NaN                         NaN   \n",
       "18151                    NaN       SC      NaN                         NaN   \n",
       "18152                    NaN       FL      NaN     http://smoothieking.com   \n",
       "18153                     $$       FL      NaN  http://www.bucadibeppo.com   \n",
       "18154                    NaN       DE      NaN                         NaN   \n",
       "\n",
       "      facebookpageurl  \n",
       "0                 NaN  \n",
       "1                 NaN  \n",
       "2                 NaN  \n",
       "3                 NaN  \n",
       "4                 NaN  \n",
       "...               ...  \n",
       "18150             NaN  \n",
       "18151             NaN  \n",
       "18152             NaN  \n",
       "18153             NaN  \n",
       "18154             NaN  \n",
       "\n",
       "[18155 rows x 13 columns]"
      ]
     },
     "execution_count": 63,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Create a filtered dataframe from specific columns\n",
    "vvr_cols = [\"index\",\"address\", \"categories\", \"city\", \"country\", \"name\", \"phones\", \"postalCode\", \"priceRange\", \"province\", \"twitter\", \"websites\", \"facebookPageURL\"]\n",
    "vvr_transformed= vvr_indexed_df[vvr_cols].copy()\n",
    "\n",
    "# Rename the column headers\n",
    "vvr_transformed = vvr_transformed.rename(columns={\"postalCode\": \"postalcode\",\n",
    "                                                  \"priceRange\": \"pricerange\",\n",
    "                                                  \"index\":\"id\",\n",
    "                                                  \"facebookPageURL\": \"facebookpageurl\"})\n",
    "\n",
    "# Clean the data by dropping duplicates and setting the index\n",
    "# vvr_transformed.drop_duplicates(\"id\", inplace=True)\n",
    "# vvr_transformed.set_index(\"id\", inplace=True)\n",
    "\n",
    "vvr_transformed"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>address</th>\n",
       "      <th>categories</th>\n",
       "      <th>city</th>\n",
       "      <th>country</th>\n",
       "      <th>name</th>\n",
       "      <th>phones</th>\n",
       "      <th>postalcode</th>\n",
       "      <th>pricerange</th>\n",
       "      <th>province</th>\n",
       "      <th>twitter</th>\n",
       "      <th>websites</th>\n",
       "      <th>facebookpageurl</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>2871 Gulf To Bay Blvd</td>\n",
       "      <td>American, American (new), Clearwater Restauran...</td>\n",
       "      <td>Clearwater</td>\n",
       "      <td>US</td>\n",
       "      <td>Village Inn Restaurant and Bakery</td>\n",
       "      <td>7277964988</td>\n",
       "      <td>33759</td>\n",
       "      <td>NaN</td>\n",
       "      <td>FL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>605 W Main St</td>\n",
       "      <td>Caf and Sandwich Place</td>\n",
       "      <td>Louisville</td>\n",
       "      <td>US</td>\n",
       "      <td>Atlantic No. 5</td>\n",
       "      <td>5028833398</td>\n",
       "      <td>40202</td>\n",
       "      <td>USD 25.00-40.00</td>\n",
       "      <td>KY</td>\n",
       "      <td>NaN</td>\n",
       "      <td>atlanticno5.com</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>3803 9th St S W</td>\n",
       "      <td>American, Barbecue, Puyallup Restaurants, Barb...</td>\n",
       "      <td>Puyallup</td>\n",
       "      <td>US</td>\n",
       "      <td>Famous Dave's</td>\n",
       "      <td>2536040340</td>\n",
       "      <td>98373</td>\n",
       "      <td>USD 10.00 - USD 15.00</td>\n",
       "      <td>WA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>http://famousdaves.com</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>30 S Main St</td>\n",
       "      <td>Coffee &amp; Tea, Restaurant, Restaurants, Bar, Am...</td>\n",
       "      <td>Oberlin</td>\n",
       "      <td>US</td>\n",
       "      <td>The Feve</td>\n",
       "      <td>[\"4407741978\",\"4197741978\",\"4407753064\"]</td>\n",
       "      <td>44074</td>\n",
       "      <td>USD 25.00-40.00</td>\n",
       "      <td>OH</td>\n",
       "      <td>NaN</td>\n",
       "      <td>http://www.thefeve.com</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>55 Crescent Dr</td>\n",
       "      <td>Sandwich Place and Fast Food Restaurant</td>\n",
       "      <td>Pleasant Hill</td>\n",
       "      <td>US</td>\n",
       "      <td>Quiznos</td>\n",
       "      <td>9258258644</td>\n",
       "      <td>94523</td>\n",
       "      <td>$</td>\n",
       "      <td>CA</td>\n",
       "      <td>quiznos</td>\n",
       "      <td>http://www.yallamedi.com/</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18150</th>\n",
       "      <td>18150</td>\n",
       "      <td>879 Smith Ave S</td>\n",
       "      <td>West St Paul Restaurants, American / Diner / C...</td>\n",
       "      <td>W St Paul</td>\n",
       "      <td>US</td>\n",
       "      <td>The Old Man River Cafe</td>\n",
       "      <td>6.51E+09</td>\n",
       "      <td>55118</td>\n",
       "      <td>NaN</td>\n",
       "      <td>MN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18151</th>\n",
       "      <td>18151</td>\n",
       "      <td>1410 Colonial Life Blvd W</td>\n",
       "      <td>Restaurant</td>\n",
       "      <td>Columbia</td>\n",
       "      <td>US</td>\n",
       "      <td>The Melting Pot</td>\n",
       "      <td>8037318500</td>\n",
       "      <td>29210-7665</td>\n",
       "      <td>NaN</td>\n",
       "      <td>SC</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18152</th>\n",
       "      <td>18152</td>\n",
       "      <td>9439 Sheridan St</td>\n",
       "      <td>American, Smoothies &amp; Juices, Hollywood Restau...</td>\n",
       "      <td>Hollywood</td>\n",
       "      <td>US</td>\n",
       "      <td>Smoothie King</td>\n",
       "      <td>9544313411</td>\n",
       "      <td>33024</td>\n",
       "      <td>NaN</td>\n",
       "      <td>FL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>http://smoothieking.com</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18153</th>\n",
       "      <td>18153</td>\n",
       "      <td>801 N Congress Ave</td>\n",
       "      <td>[\"Restaurants\",\"Banquet Halls &amp; Reception Faci...</td>\n",
       "      <td>Boynton Beach</td>\n",
       "      <td>US</td>\n",
       "      <td>Buca Di Beppo</td>\n",
       "      <td>[\"5617344558\",\"5617330189\"]</td>\n",
       "      <td>[\"33426\"]</td>\n",
       "      <td>$$</td>\n",
       "      <td>FL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>http://www.bucadibeppo.com</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18154</th>\n",
       "      <td>18154</td>\n",
       "      <td>1603 Delaware 1</td>\n",
       "      <td>Rehoboth Beach Restaurants, Pizza / American /...</td>\n",
       "      <td>Rehoboth Beach</td>\n",
       "      <td>US</td>\n",
       "      <td>Grotto Pizza</td>\n",
       "      <td>3022273407</td>\n",
       "      <td>19971</td>\n",
       "      <td>NaN</td>\n",
       "      <td>DE</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>17624 rows × 13 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          id                    address  \\\n",
       "0          0      2871 Gulf To Bay Blvd   \n",
       "1          1              605 W Main St   \n",
       "2          2            3803 9th St S W   \n",
       "3          3               30 S Main St   \n",
       "4          4             55 Crescent Dr   \n",
       "...      ...                        ...   \n",
       "18150  18150            879 Smith Ave S   \n",
       "18151  18151  1410 Colonial Life Blvd W   \n",
       "18152  18152           9439 Sheridan St   \n",
       "18153  18153         801 N Congress Ave   \n",
       "18154  18154            1603 Delaware 1   \n",
       "\n",
       "                                              categories            city  \\\n",
       "0      American, American (new), Clearwater Restauran...      Clearwater   \n",
       "1                                 Caf and Sandwich Place      Louisville   \n",
       "2      American, Barbecue, Puyallup Restaurants, Barb...        Puyallup   \n",
       "3      Coffee & Tea, Restaurant, Restaurants, Bar, Am...         Oberlin   \n",
       "4                Sandwich Place and Fast Food Restaurant   Pleasant Hill   \n",
       "...                                                  ...             ...   \n",
       "18150  West St Paul Restaurants, American / Diner / C...       W St Paul   \n",
       "18151                                         Restaurant        Columbia   \n",
       "18152  American, Smoothies & Juices, Hollywood Restau...       Hollywood   \n",
       "18153  [\"Restaurants\",\"Banquet Halls & Reception Faci...   Boynton Beach   \n",
       "18154  Rehoboth Beach Restaurants, Pizza / American /...  Rehoboth Beach   \n",
       "\n",
       "      country                               name  \\\n",
       "0          US  Village Inn Restaurant and Bakery   \n",
       "1          US                     Atlantic No. 5   \n",
       "2          US                      Famous Dave's   \n",
       "3          US                           The Feve   \n",
       "4          US                            Quiznos   \n",
       "...       ...                                ...   \n",
       "18150      US             The Old Man River Cafe   \n",
       "18151      US                    The Melting Pot   \n",
       "18152      US                      Smoothie King   \n",
       "18153      US                      Buca Di Beppo   \n",
       "18154      US                       Grotto Pizza   \n",
       "\n",
       "                                         phones  postalcode  \\\n",
       "0                                    7277964988       33759   \n",
       "1                                    5028833398       40202   \n",
       "2                                    2536040340       98373   \n",
       "3      [\"4407741978\",\"4197741978\",\"4407753064\"]       44074   \n",
       "4                                    9258258644       94523   \n",
       "...                                         ...         ...   \n",
       "18150                                  6.51E+09       55118   \n",
       "18151                                8037318500  29210-7665   \n",
       "18152                                9544313411       33024   \n",
       "18153               [\"5617344558\",\"5617330189\"]   [\"33426\"]   \n",
       "18154                                3022273407       19971   \n",
       "\n",
       "                  pricerange province  twitter                    websites  \\\n",
       "0                        NaN       FL      NaN                         NaN   \n",
       "1            USD 25.00-40.00       KY      NaN             atlanticno5.com   \n",
       "2      USD 10.00 - USD 15.00       WA      NaN      http://famousdaves.com   \n",
       "3            USD 25.00-40.00       OH      NaN      http://www.thefeve.com   \n",
       "4                          $       CA  quiznos   http://www.yallamedi.com/   \n",
       "...                      ...      ...      ...                         ...   \n",
       "18150                    NaN       MN      NaN                         NaN   \n",
       "18151                    NaN       SC      NaN                         NaN   \n",
       "18152                    NaN       FL      NaN     http://smoothieking.com   \n",
       "18153                     $$       FL      NaN  http://www.bucadibeppo.com   \n",
       "18154                    NaN       DE      NaN                         NaN   \n",
       "\n",
       "      facebookpageurl  \n",
       "0                 NaN  \n",
       "1                 NaN  \n",
       "2                 NaN  \n",
       "3                 NaN  \n",
       "4                 NaN  \n",
       "...               ...  \n",
       "18150             NaN  \n",
       "18151             NaN  \n",
       "18152             NaN  \n",
       "18153             NaN  \n",
       "18154             NaN  \n",
       "\n",
       "[17624 rows x 13 columns]"
      ]
     },
     "execution_count": 64,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vvr_transformed = vvr_transformed[~vvr_transformed.name.str.contains(\"closed\", na=False) == True]\n",
    "vvr_transformed = vvr_transformed[~vvr_transformed.name.str.contains(\"Closed\", na=False) == True]\n",
    "vvr_transformed\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>address</th>\n",
       "      <th>categories</th>\n",
       "      <th>city</th>\n",
       "      <th>country</th>\n",
       "      <th>name</th>\n",
       "      <th>phones</th>\n",
       "      <th>postalcode</th>\n",
       "      <th>pricerange</th>\n",
       "      <th>province</th>\n",
       "      <th>twitter</th>\n",
       "      <th>websites</th>\n",
       "      <th>facebookpageurl</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>0</td>\n",
       "      <td>2871 Gulf To Bay Blvd</td>\n",
       "      <td>American, American (new), Clearwater Restauran...</td>\n",
       "      <td>Clearwater</td>\n",
       "      <td>US</td>\n",
       "      <td>Village Inn Restaurant and Bakery</td>\n",
       "      <td>7277964988</td>\n",
       "      <td>33759</td>\n",
       "      <td>NaN</td>\n",
       "      <td>FL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>605 W Main St</td>\n",
       "      <td>Caf and Sandwich Place</td>\n",
       "      <td>Louisville</td>\n",
       "      <td>US</td>\n",
       "      <td>Atlantic No. 5</td>\n",
       "      <td>5028833398</td>\n",
       "      <td>40202</td>\n",
       "      <td>USD 25.00-40.00</td>\n",
       "      <td>KY</td>\n",
       "      <td>NaN</td>\n",
       "      <td>atlanticno5.com</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>3803 9th St S W</td>\n",
       "      <td>American, Barbecue, Puyallup Restaurants, Barb...</td>\n",
       "      <td>Puyallup</td>\n",
       "      <td>US</td>\n",
       "      <td>Famous Dave's</td>\n",
       "      <td>2536040340</td>\n",
       "      <td>98373</td>\n",
       "      <td>USD 10.00 - USD 15.00</td>\n",
       "      <td>WA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>http://famousdaves.com</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>30 S Main St</td>\n",
       "      <td>Coffee &amp; Tea, Restaurant, Restaurants, Bar, Am...</td>\n",
       "      <td>Oberlin</td>\n",
       "      <td>US</td>\n",
       "      <td>The Feve</td>\n",
       "      <td>[\"4407741978\",\"4197741978\",\"4407753064\"]</td>\n",
       "      <td>44074</td>\n",
       "      <td>USD 25.00-40.00</td>\n",
       "      <td>OH</td>\n",
       "      <td>NaN</td>\n",
       "      <td>http://www.thefeve.com</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>55 Crescent Dr</td>\n",
       "      <td>Sandwich Place and Fast Food Restaurant</td>\n",
       "      <td>Pleasant Hill</td>\n",
       "      <td>US</td>\n",
       "      <td>Quiznos</td>\n",
       "      <td>9258258644</td>\n",
       "      <td>94523</td>\n",
       "      <td>$</td>\n",
       "      <td>CA</td>\n",
       "      <td>quiznos</td>\n",
       "      <td>http://www.yallamedi.com/</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18149</th>\n",
       "      <td>18149</td>\n",
       "      <td>9 Orchard Hill Sq</td>\n",
       "      <td>Caterers</td>\n",
       "      <td>Staunton</td>\n",
       "      <td>US</td>\n",
       "      <td>Brother's Catering</td>\n",
       "      <td>5402552884</td>\n",
       "      <td>24401</td>\n",
       "      <td>NaN</td>\n",
       "      <td>VA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>http://www.brotherscateringstaunton.com</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18150</th>\n",
       "      <td>18150</td>\n",
       "      <td>879 Smith Ave S</td>\n",
       "      <td>West St Paul Restaurants, American / Diner / C...</td>\n",
       "      <td>W St Paul</td>\n",
       "      <td>US</td>\n",
       "      <td>The Old Man River Cafe</td>\n",
       "      <td>6.51E+09</td>\n",
       "      <td>55118</td>\n",
       "      <td>NaN</td>\n",
       "      <td>MN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18151</th>\n",
       "      <td>18151</td>\n",
       "      <td>1410 Colonial Life Blvd W</td>\n",
       "      <td>Restaurant</td>\n",
       "      <td>Columbia</td>\n",
       "      <td>US</td>\n",
       "      <td>The Melting Pot</td>\n",
       "      <td>8037318500</td>\n",
       "      <td>29210</td>\n",
       "      <td>NaN</td>\n",
       "      <td>SC</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18152</th>\n",
       "      <td>18152</td>\n",
       "      <td>9439 Sheridan St</td>\n",
       "      <td>American, Smoothies &amp; Juices, Hollywood Restau...</td>\n",
       "      <td>Hollywood</td>\n",
       "      <td>US</td>\n",
       "      <td>Smoothie King</td>\n",
       "      <td>9544313411</td>\n",
       "      <td>33024</td>\n",
       "      <td>NaN</td>\n",
       "      <td>FL</td>\n",
       "      <td>NaN</td>\n",
       "      <td>http://smoothieking.com</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18154</th>\n",
       "      <td>18154</td>\n",
       "      <td>1603 Delaware 1</td>\n",
       "      <td>Rehoboth Beach Restaurants, Pizza / American /...</td>\n",
       "      <td>Rehoboth Beach</td>\n",
       "      <td>US</td>\n",
       "      <td>Grotto Pizza</td>\n",
       "      <td>3022273407</td>\n",
       "      <td>19971</td>\n",
       "      <td>NaN</td>\n",
       "      <td>DE</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>13474 rows × 13 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          id                    address  \\\n",
       "0          0      2871 Gulf To Bay Blvd   \n",
       "1          1              605 W Main St   \n",
       "2          2            3803 9th St S W   \n",
       "3          3               30 S Main St   \n",
       "4          4             55 Crescent Dr   \n",
       "...      ...                        ...   \n",
       "18149  18149          9 Orchard Hill Sq   \n",
       "18150  18150            879 Smith Ave S   \n",
       "18151  18151  1410 Colonial Life Blvd W   \n",
       "18152  18152           9439 Sheridan St   \n",
       "18154  18154            1603 Delaware 1   \n",
       "\n",
       "                                              categories            city  \\\n",
       "0      American, American (new), Clearwater Restauran...      Clearwater   \n",
       "1                                 Caf and Sandwich Place      Louisville   \n",
       "2      American, Barbecue, Puyallup Restaurants, Barb...        Puyallup   \n",
       "3      Coffee & Tea, Restaurant, Restaurants, Bar, Am...         Oberlin   \n",
       "4                Sandwich Place and Fast Food Restaurant   Pleasant Hill   \n",
       "...                                                  ...             ...   \n",
       "18149                                           Caterers        Staunton   \n",
       "18150  West St Paul Restaurants, American / Diner / C...       W St Paul   \n",
       "18151                                         Restaurant        Columbia   \n",
       "18152  American, Smoothies & Juices, Hollywood Restau...       Hollywood   \n",
       "18154  Rehoboth Beach Restaurants, Pizza / American /...  Rehoboth Beach   \n",
       "\n",
       "      country                               name  \\\n",
       "0          US  Village Inn Restaurant and Bakery   \n",
       "1          US                     Atlantic No. 5   \n",
       "2          US                      Famous Dave's   \n",
       "3          US                           The Feve   \n",
       "4          US                            Quiznos   \n",
       "...       ...                                ...   \n",
       "18149      US                 Brother's Catering   \n",
       "18150      US             The Old Man River Cafe   \n",
       "18151      US                    The Melting Pot   \n",
       "18152      US                      Smoothie King   \n",
       "18154      US                       Grotto Pizza   \n",
       "\n",
       "                                         phones postalcode  \\\n",
       "0                                    7277964988      33759   \n",
       "1                                    5028833398      40202   \n",
       "2                                    2536040340      98373   \n",
       "3      [\"4407741978\",\"4197741978\",\"4407753064\"]      44074   \n",
       "4                                    9258258644      94523   \n",
       "...                                         ...        ...   \n",
       "18149                                5402552884      24401   \n",
       "18150                                  6.51E+09      55118   \n",
       "18151                                8037318500      29210   \n",
       "18152                                9544313411      33024   \n",
       "18154                                3022273407      19971   \n",
       "\n",
       "                  pricerange province  twitter  \\\n",
       "0                        NaN       FL      NaN   \n",
       "1            USD 25.00-40.00       KY      NaN   \n",
       "2      USD 10.00 - USD 15.00       WA      NaN   \n",
       "3            USD 25.00-40.00       OH      NaN   \n",
       "4                          $       CA  quiznos   \n",
       "...                      ...      ...      ...   \n",
       "18149                    NaN       VA      NaN   \n",
       "18150                    NaN       MN      NaN   \n",
       "18151                    NaN       SC      NaN   \n",
       "18152                    NaN       FL      NaN   \n",
       "18154                    NaN       DE      NaN   \n",
       "\n",
       "                                      websites facebookpageurl  \n",
       "0                                          NaN             NaN  \n",
       "1                              atlanticno5.com             NaN  \n",
       "2                       http://famousdaves.com             NaN  \n",
       "3                       http://www.thefeve.com             NaN  \n",
       "4                    http://www.yallamedi.com/             NaN  \n",
       "...                                        ...             ...  \n",
       "18149  http://www.brotherscateringstaunton.com             NaN  \n",
       "18150                                      NaN             NaN  \n",
       "18151                                      NaN             NaN  \n",
       "18152                  http://smoothieking.com             NaN  \n",
       "18154                                      NaN             NaN  \n",
       "\n",
       "[13474 rows x 13 columns]"
      ]
     },
     "execution_count": 68,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vvr_transformed['postalcode'] = vvr_transformed['postalcode'].str.extract(r'^(\\d{5})', expand=False)\n",
    "vvr_transformed = vvr_transformed[vvr_transformed['postalcode'].notna()]\n",
    "vvr_transformed"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>id</th>\n",
       "      <th>address</th>\n",
       "      <th>categories</th>\n",
       "      <th>city</th>\n",
       "      <th>country</th>\n",
       "      <th>name</th>\n",
       "      <th>phones</th>\n",
       "      <th>postalcode</th>\n",
       "      <th>pricerange</th>\n",
       "      <th>province</th>\n",
       "      <th>twitter</th>\n",
       "      <th>websites</th>\n",
       "      <th>facebookpageurl</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>1</td>\n",
       "      <td>605 W Main St</td>\n",
       "      <td>Caf and Sandwich Place</td>\n",
       "      <td>Louisville</td>\n",
       "      <td>US</td>\n",
       "      <td>Atlantic No. 5</td>\n",
       "      <td>5028833398</td>\n",
       "      <td>40202</td>\n",
       "      <td>None</td>\n",
       "      <td>KY</td>\n",
       "      <td>NaN</td>\n",
       "      <td>atlanticno5.com</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>2</td>\n",
       "      <td>3803 9th St S W</td>\n",
       "      <td>American, Barbecue, Puyallup Restaurants, Barb...</td>\n",
       "      <td>Puyallup</td>\n",
       "      <td>US</td>\n",
       "      <td>Famous Dave's</td>\n",
       "      <td>2536040340</td>\n",
       "      <td>98373</td>\n",
       "      <td>None</td>\n",
       "      <td>WA</td>\n",
       "      <td>NaN</td>\n",
       "      <td>http://famousdaves.com</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>3</td>\n",
       "      <td>30 S Main St</td>\n",
       "      <td>Coffee &amp; Tea, Restaurant, Restaurants, Bar, Am...</td>\n",
       "      <td>Oberlin</td>\n",
       "      <td>US</td>\n",
       "      <td>The Feve</td>\n",
       "      <td>[\"4407741978\",\"4197741978\",\"4407753064\"]</td>\n",
       "      <td>44074</td>\n",
       "      <td>None</td>\n",
       "      <td>OH</td>\n",
       "      <td>NaN</td>\n",
       "      <td>http://www.thefeve.com</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>4</td>\n",
       "      <td>55 Crescent Dr</td>\n",
       "      <td>Sandwich Place and Fast Food Restaurant</td>\n",
       "      <td>Pleasant Hill</td>\n",
       "      <td>US</td>\n",
       "      <td>Quiznos</td>\n",
       "      <td>9258258644</td>\n",
       "      <td>94523</td>\n",
       "      <td>None</td>\n",
       "      <td>CA</td>\n",
       "      <td>quiznos</td>\n",
       "      <td>http://www.yallamedi.com/</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>7</td>\n",
       "      <td>415 Thompson Ln</td>\n",
       "      <td>Nashville Restaurants, Glencliff Estates, Rest...</td>\n",
       "      <td>Nashville</td>\n",
       "      <td>US</td>\n",
       "      <td>Lalibela Ethiopian Cuisine</td>\n",
       "      <td>6153320710</td>\n",
       "      <td>37211</td>\n",
       "      <td>None</td>\n",
       "      <td>TN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18101</th>\n",
       "      <td>18101</td>\n",
       "      <td>4 E Madison St</td>\n",
       "      <td>Restaurants, Baltimore Restaurants, Mount Vern...</td>\n",
       "      <td>Baltimore</td>\n",
       "      <td>US</td>\n",
       "      <td>Feast @ 4 East</td>\n",
       "      <td>4106052020</td>\n",
       "      <td>21202</td>\n",
       "      <td>None</td>\n",
       "      <td>MD</td>\n",
       "      <td>NaN</td>\n",
       "      <td>http://www.4eastmadisoninn.com</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18102</th>\n",
       "      <td>18102</td>\n",
       "      <td>7334 Tylers Corner Dr</td>\n",
       "      <td>Asian, Sushi, Thai, Restaurant, West Chester R...</td>\n",
       "      <td>W Chester</td>\n",
       "      <td>US</td>\n",
       "      <td>Miso - West Chester</td>\n",
       "      <td>5137791807</td>\n",
       "      <td>45069</td>\n",
       "      <td>None</td>\n",
       "      <td>OH</td>\n",
       "      <td>NaN</td>\n",
       "      <td>http://www.misocincinnati.com/</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18139</th>\n",
       "      <td>18139</td>\n",
       "      <td>8931 N Yates St</td>\n",
       "      <td>Westminster Restaurants, American, Restaurants...</td>\n",
       "      <td>Westminster</td>\n",
       "      <td>US</td>\n",
       "      <td>Saltgrass Steak House</td>\n",
       "      <td>3034294300</td>\n",
       "      <td>80031</td>\n",
       "      <td>None</td>\n",
       "      <td>CO</td>\n",
       "      <td>saltgrasssteak</td>\n",
       "      <td>NaN</td>\n",
       "      <td>http://facebook.com/308969879719</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18143</th>\n",
       "      <td>18143</td>\n",
       "      <td>9729 Belleville Rd</td>\n",
       "      <td>American, Restaurant, Belleville Restaurants, ...</td>\n",
       "      <td>Belleville</td>\n",
       "      <td>US</td>\n",
       "      <td>O'charley's Belleville Mi - Hours Reviews &amp; More</td>\n",
       "      <td>7346976201</td>\n",
       "      <td>48111</td>\n",
       "      <td>None</td>\n",
       "      <td>MI</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18148</th>\n",
       "      <td>18148</td>\n",
       "      <td>1839 Winderly Ln</td>\n",
       "      <td>Greek, Mediterranean, Vegetarian</td>\n",
       "      <td>Pickerington</td>\n",
       "      <td>US</td>\n",
       "      <td>Feta Greek Kuzina</td>\n",
       "      <td>6148643382</td>\n",
       "      <td>43147</td>\n",
       "      <td>None</td>\n",
       "      <td>OH</td>\n",
       "      <td>NaN</td>\n",
       "      <td>http://www.bestgreekusa.com/</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5785 rows × 13 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "          id                address  \\\n",
       "1          1          605 W Main St   \n",
       "2          2        3803 9th St S W   \n",
       "3          3           30 S Main St   \n",
       "4          4         55 Crescent Dr   \n",
       "7          7        415 Thompson Ln   \n",
       "...      ...                    ...   \n",
       "18101  18101         4 E Madison St   \n",
       "18102  18102  7334 Tylers Corner Dr   \n",
       "18139  18139        8931 N Yates St   \n",
       "18143  18143     9729 Belleville Rd   \n",
       "18148  18148       1839 Winderly Ln   \n",
       "\n",
       "                                              categories           city  \\\n",
       "1                                 Caf and Sandwich Place     Louisville   \n",
       "2      American, Barbecue, Puyallup Restaurants, Barb...       Puyallup   \n",
       "3      Coffee & Tea, Restaurant, Restaurants, Bar, Am...        Oberlin   \n",
       "4                Sandwich Place and Fast Food Restaurant  Pleasant Hill   \n",
       "7      Nashville Restaurants, Glencliff Estates, Rest...      Nashville   \n",
       "...                                                  ...            ...   \n",
       "18101  Restaurants, Baltimore Restaurants, Mount Vern...      Baltimore   \n",
       "18102  Asian, Sushi, Thai, Restaurant, West Chester R...      W Chester   \n",
       "18139  Westminster Restaurants, American, Restaurants...    Westminster   \n",
       "18143  American, Restaurant, Belleville Restaurants, ...     Belleville   \n",
       "18148                   Greek, Mediterranean, Vegetarian   Pickerington   \n",
       "\n",
       "      country                                              name  \\\n",
       "1          US                                    Atlantic No. 5   \n",
       "2          US                                     Famous Dave's   \n",
       "3          US                                          The Feve   \n",
       "4          US                                           Quiznos   \n",
       "7          US                        Lalibela Ethiopian Cuisine   \n",
       "...       ...                                               ...   \n",
       "18101      US                                    Feast @ 4 East   \n",
       "18102      US                               Miso - West Chester   \n",
       "18139      US                             Saltgrass Steak House   \n",
       "18143      US  O'charley's Belleville Mi - Hours Reviews & More   \n",
       "18148      US                                 Feta Greek Kuzina   \n",
       "\n",
       "                                         phones postalcode pricerange  \\\n",
       "1                                    5028833398      40202       None   \n",
       "2                                    2536040340      98373       None   \n",
       "3      [\"4407741978\",\"4197741978\",\"4407753064\"]      44074       None   \n",
       "4                                    9258258644      94523       None   \n",
       "7                                    6153320710      37211       None   \n",
       "...                                         ...        ...        ...   \n",
       "18101                                4106052020      21202       None   \n",
       "18102                                5137791807      45069       None   \n",
       "18139                                3034294300      80031       None   \n",
       "18143                                7346976201      48111       None   \n",
       "18148                                6148643382      43147       None   \n",
       "\n",
       "      province         twitter                        websites  \\\n",
       "1           KY             NaN                 atlanticno5.com   \n",
       "2           WA             NaN          http://famousdaves.com   \n",
       "3           OH             NaN          http://www.thefeve.com   \n",
       "4           CA         quiznos       http://www.yallamedi.com/   \n",
       "7           TN             NaN                             NaN   \n",
       "...        ...             ...                             ...   \n",
       "18101       MD             NaN  http://www.4eastmadisoninn.com   \n",
       "18102       OH             NaN  http://www.misocincinnati.com/   \n",
       "18139       CO  saltgrasssteak                             NaN   \n",
       "18143       MI             NaN                             NaN   \n",
       "18148       OH             NaN    http://www.bestgreekusa.com/   \n",
       "\n",
       "                        facebookpageurl  \n",
       "1                                   NaN  \n",
       "2                                   NaN  \n",
       "3                                   NaN  \n",
       "4                                   NaN  \n",
       "7                                   NaN  \n",
       "...                                 ...  \n",
       "18101                               NaN  \n",
       "18102                               NaN  \n",
       "18139  http://facebook.com/308969879719  \n",
       "18143                               NaN  \n",
       "18148                               NaN  \n",
       "\n",
       "[5785 rows x 13 columns]"
      ]
     },
     "execution_count": 70,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vvr_transformed = vvr_transformed[vvr_transformed['pricerange'].notna()]\n",
    "# vvr_transformed\n",
    "vvr_transformed['pricerange']= vvr_transformed['pricerange'].replace('$', '',inplace = True)\n",
    "vvr_transformed"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Transform county DataFrame"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [],
   "source": [
    "# county_cols = [\"ID\", \"County Name (Licensee)\", \"County ID Code\", \"License Count\"]\n",
    "# county_transformed = county_df[county_cols].copy()\n",
    "\n",
    "# # Rename the column headers\n",
    "# county_transformed = county_transformed.rename(columns={\"ID\": \"id\",\n",
    "#                                                          \"County Name (Licensee)\": \"county_name\",\n",
    "#                                                          \"License Count\": \"license_count\",\n",
    "#                                                          \"County ID Code\": \"county_id\"})\n",
    "\n",
    "# # Set index\n",
    "# county_transformed.set_index(\"id\", inplace=True)\n",
    "\n",
    "# county_transformed.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Create database connection"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "connection_string = \"postgres:postgres@localhost:5432/vegan_ram\"\n",
    "engine = create_engine(f'postgresql://{connection_string}')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "<ipython-input-8-2d97e9123e98>:2: SADeprecationWarning: The Engine.table_names() method is deprecated and will be removed in a future release.  Please refer to Inspector.get_table_names(). (deprecated since: 1.4)\n",
      "  engine.table_names()\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "['vvr']"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Confirm tables\n",
    "engine.table_names()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Load DataFrames into database"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "# vvr_transformed.to_sql(name='vvr', con=engine, if_exists='append', index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "# county_transformed.to_sql(name='county', con=engine, if_exists='append', index=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
